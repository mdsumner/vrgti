% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vrt_to_gti.R
\name{vrt_to_gti}
\alias{vrt_to_gti}
\title{Convert a VRT mosaic to a GTI tile index}
\usage{
vrt_to_gti(
  dsn,
  output,
  layer = "tile_index",
  location_field = "location",
  relative_paths = FALSE,
  overwrite = FALSE
)
}
\arguments{
\item{dsn}{Character string. Path or URL to a VRT file. Supports
\verb{/vsicurl/} prefixed URLs.}

\item{output}{Character string. Output file path. The format is inferred
from the extension: \code{.gpkg} for GeoPackage (default recommendation),
\code{.fgb} for FlatGeoBuf. These formats support layer metadata required
by GTI.}

\item{layer}{Character string. Layer name in the output dataset.
Defaults to \code{"tile_index"}.}

\item{location_field}{Character string. Name of the field that stores
tile file paths. Defaults to \code{"location"} (the GTI default).}

\item{relative_paths}{Logical. If \code{TRUE}, store paths relative to the
output file location. If \code{FALSE} (default), store absolute/resolved paths.}

\item{overwrite}{Logical. If \code{TRUE}, delete existing output file before
writing.}
}
\value{
Invisibly, the output file path. The file can be opened as a GTI
raster datasource, e.g. \verb{GTI:<output>}.
}
\description{
Parses a GDAL VRT file, validates that it is a simple mosaic, computes
tile footprint polygons from the DstRect pixel coordinates and GeoTransform,
and writes a GTI-compatible vector dataset (GeoPackage by default) with
appropriate layer metadata.
}
\details{
The function performs the following steps:
\enumerate{
\item \strong{Parse}: Read the VRT XML and extract source information.
\item \strong{Validate}: Ensure the VRT is a simple mosaic (SimpleSource only,
consistent bands, no resampling).
\item \strong{Compute extents}: Convert DstRect pixel coordinates to geographic
extents using the VRT's GeoTransform. Extents are pixel-edge aligned.
\item \strong{Resolve paths}: Handle \code{relativeToVRT} attributes, resolving source
file paths against the VRT location.
\item \strong{Write}: Create a GeoPackage (or FlatGeoBuf) with polygon footprints
and a \code{location} field, using \link[gdalraster:GDALVector-class]{gdalraster::GDALVector}.
\item \strong{Set metadata}: Write GTI layer metadata items (RESX, RESY, MINX,
MINY, MAXX, MAXY, BAND_COUNT, DATA_TYPE, NODATA, SRS).
}
}
\examples{
\dontrun{
vrt_to_gti(
  dsn = "/vsicurl/https://example.com/REMA-2m_dem_ovr.vrt",
  output = "rema_tiles.gpkg"
)

# Open with GDAL
library(gdalraster)
ds <- new(GDALRaster, "GTI:rema_tiles.gpkg")
}
}
